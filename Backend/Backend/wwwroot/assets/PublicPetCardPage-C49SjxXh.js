import{e as k,j as t,r as e,u as E,M as L,B as h,c as S,a as f,G as M,f as W}from"./index-BkwN6ugi.js";import{L as F}from"./LoadingIndicator-CnG4_zX-.js";import{c as N,s as R,P as A,a as O}from"./PetCard-BcbDt9U2.js";import{T as g}from"./TextField-Xo4kt7zH.js";import"./Edit-DyYhkn_S.js";import"./Grow-CBhhKj-Z.js";import"./isHostComponent-DVu5iVWx.js";import"./Avatar-DYU2TdCn.js";import"./SwitchBase-CjQjlEQE.js";import"./Grid-CFPI6i8Q.js";import"./isMuiElement-BIwZpEg9.js";import"./Select-CVW7Cr0N.js";import"./List-CSE9cjs2.js";const B=k(t.jsx("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7"}),"MyLocation");function D({open:x,onClose:o,petId:m}){const[s,p]=e.useState(""),[l,c]=e.useState(""),[d,i]=e.useState(""),b=E(),u=async()=>{var r;if(!s.trim()||!l.trim()){alert("Please enter your first name and surname.");return}try{const n=await N({petId:m,finderName:s,finderSurname:l,finderEmail:d});n.chatSessionId?(sessionStorage.setItem("finderEphemeralId",n.finderEphemeralId),sessionStorage.setItem("chatSessionId",n.chatSessionId),b(`/chat/${n.chatSessionId}`)):alert("Failed to start chat. Please try again.")}catch(n){console.error("Error starting chat:",((r=n.response)==null?void 0:r.data)||n.message),alert("An error occurred while starting the chat.")}},v=()=>{p(""),c(""),i(""),o()};return t.jsx(L,{open:x,onClose:v,children:t.jsxs(h,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"var(--card-background)",boxShadow:24,borderRadius:2,p:4,minWidth:320,color:"var(--text-color)"},children:[t.jsx(S,{variant:"h5",sx:{mb:2,textAlign:"center"},children:"Start Chat with Pet Owner"}),t.jsx(S,{variant:"body2",sx:{mb:2},children:"Please enter your details before starting the chat:"}),t.jsx(g,{fullWidth:!0,label:"First Name",value:s,onChange:r=>p(r.target.value),sx:{mb:2,input:{color:"var(--text-color)"}},InputLabelProps:{style:{color:"var(--text-color)"}}}),t.jsx(g,{fullWidth:!0,label:"Surname",value:l,onChange:r=>c(r.target.value),sx:{mb:2,input:{color:"var(--text-color)"}},InputLabelProps:{style:{color:"var(--text-color)"}}}),t.jsx(g,{fullWidth:!0,label:"Email (optional)",type:"email",value:d,onChange:r=>i(r.target.value),sx:{mb:3,input:{color:"var(--text-color)"}},InputLabelProps:{style:{color:"var(--text-color)"}}}),t.jsxs(h,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[t.jsx(f,{variant:"outlined",color:"error",onClick:v,children:"Cancel"}),t.jsx(f,{variant:"contained",onClick:u,sx:{backgroundColor:"var(--primary-color)",color:"white"},children:"Start Chat"})]})]})})}function G({open:x,onClose:o,petCardID:m}){const[s,p]=e.useState(""),[l,c]=e.useState(""),[d,i]=e.useState(""),[b,u]=e.useState(null),[v,r]=e.useState(null),[n,C]=e.useState(!1),I=()=>{if(C(!0),!navigator.geolocation){alert("Geolocation is not supported by your browser."),C(!1);return}navigator.geolocation.getCurrentPosition(a=>{const j=a.coords.latitude,y=a.coords.longitude,w=`https://www.google.com/maps?q=${j},${y}`;u(j),r(y),i(w),C(!1)},a=>{console.error("Error getting location:",a),alert("Unable to retrieve your location."),C(!1)})},P=async()=>{try{await R(m,s,l,d,b,v),o()}catch(a){console.error("Error submitting location:",a)}};return t.jsx(L,{open:x,onClose:o,children:t.jsxs(h,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"var(--card-background)",boxShadow:24,borderRadius:2,p:4,minWidth:320,color:"var(--text-color)"},children:[t.jsx(S,{variant:"h5",sx:{mb:2,textAlign:"center"},children:"Send Location"}),t.jsx(g,{fullWidth:!0,label:"Your Name",value:s,onChange:a=>p(a.target.value),sx:{mb:2,input:{color:"var(--text-color)"}},InputLabelProps:{style:{color:"var(--text-color)"}}}),t.jsx(g,{fullWidth:!0,label:"Contact Info",value:l,onChange:a=>c(a.target.value),sx:{mb:2,input:{color:"var(--text-color)"}},InputLabelProps:{style:{color:"var(--text-color)"}}}),t.jsxs(h,{sx:{display:"flex",gap:1,mb:2,alignItems:"center"},children:[t.jsx(g,{fullWidth:!0,label:"Location Found",disabled:!0,value:d,onChange:a=>i(a.target.value),sx:{input:{color:"var(--text-color)"}},InputLabelProps:{style:{color:"var(--text-color)"}}}),t.jsx(f,{onClick:I,variant:"contained",disabled:n,sx:{minWidth:"48px",height:"56px",bgcolor:"var(--primary-color)"},children:n?t.jsx(M,{size:20,sx:{color:"white"}}):t.jsx(B,{})})]}),t.jsx(h,{sx:{textAlign:"right"},children:t.jsx(f,{variant:"contained",onClick:P,sx:{backgroundColor:"var(--primary-color)",color:"white"},children:"Submit"})})]})})}const _=()=>{const{uniqueUrl:x}=W(),[o,m]=e.useState(null),[s,p]=e.useState(!0),[l,c]=e.useState(!1),[d,i]=e.useState(!1);return e.useEffect(()=>{(async()=>{try{const u=await O(x);m(u)}catch(u){console.error("Error fetching public pet card details:",u)}finally{p(!1)}})()},[x]),s?t.jsx("div",{children:t.jsx(F,{message:"Loading pet card details..."})}):t.jsxs("div",{style:{margin:0,padding:0},children:[t.jsx(A,{petDetails:o,readOnly:!0}),t.jsxs(h,{sx:{display:"flex",justifyContent:"center",alignItems:"center",gap:2,mt:3,mb:3,flexWrap:"wrap",px:2},children:[t.jsx(f,{onClick:()=>c(!0),sx:{background:"linear-gradient(to right, #00c6ff, #0072ff)",color:"#fff",fontWeight:"bold",padding:"12px 24px",borderRadius:"12px",boxShadow:"0px 6px 12px rgba(0, 114, 255, 0.3)",transition:"all 0.3s ease","&:hover":{background:"linear-gradient(to right, #0072ff, #00c6ff)",boxShadow:"0px 8px 16px rgba(0, 114, 255, 0.4)"}},children:"Start Chat"}),t.jsx(f,{onClick:()=>i(!0),sx:{background:"linear-gradient(to right, #ff6f61, #ff9478)",color:"#fff",fontWeight:"bold",padding:"12px 24px",borderRadius:"12px",boxShadow:"0px 6px 12px rgba(255, 111, 97, 0.3)",transition:"all 0.3s ease","&:hover":{background:"linear-gradient(to right, #ff9478, #ff6f61)",boxShadow:"0px 8px 16px rgba(255, 111, 97, 0.4)"}},children:"Send Location"})]}),t.jsx(D,{open:l,onClose:()=>c(!1),petId:o==null?void 0:o.petID}),t.jsx(G,{open:d,onClose:()=>i(!1),petCardID:o==null?void 0:o.petCardID})]})};export{_ as default};
