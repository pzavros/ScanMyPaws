import{r as d,s as U,q,t as N,v,w as it,x as pt,y as F,Q as rt,A as B,j as n,C as G,N as mt,ab as ot,H as st,c as O,u as gt,B as _,a as ut}from"./index-BkwN6ugi.js";import{d as ht,a as ft}from"./api-Dn10Jbrv.js";import{P as vt}from"./Page-nSfMCqEi.js";import{L as k,a as yt}from"./List-CSE9cjs2.js";import{i as nt}from"./isHostComponent-DVu5iVWx.js";import{i as xt}from"./isMuiElement-BIwZpEg9.js";import{A as bt}from"./Avatar-DYU2TdCn.js";import{l as Z,g as Ct}from"./listItemTextClasses-DSEbLqNk.js";const lt=e=>{const t=d.useRef({});return d.useEffect(()=>{t.current=e}),t.current};function It(e){const{badgeContent:t,invisible:r=!1,max:s=99,showZero:a=!1}=e,c=lt({badgeContent:t,max:s});let l=r;r===!1&&t===0&&!a&&(l=!0);const{badgeContent:i,max:o=s}=l?c:e,m=i&&Number(i)>o?`${o}+`:i;return{badgeContent:i,invisible:l,max:o,displayValue:m}}function St(e){return q("MuiBadge",e)}const L=U("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),Y=10,J=4,Rt=e=>{const{color:t,anchorOrigin:r,invisible:s,overlap:a,variant:c,classes:l={}}=e,i={root:["root"],badge:["badge",c,s&&"invisible",`anchorOrigin${v(r.vertical)}${v(r.horizontal)}`,`anchorOrigin${v(r.vertical)}${v(r.horizontal)}${v(a)}`,`overlap${v(a)}`,t!=="default"&&`color${v(t)}`]};return G(i,St,l)},Pt=N("span",{name:"MuiBadge",slot:"Root",overridesResolver:(e,t)=>t.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),Lt=N("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.badge,t[r.variant],t[`anchorOrigin${v(r.anchorOrigin.vertical)}${v(r.anchorOrigin.horizontal)}${v(r.overlap)}`],r.color!=="default"&&t[`color${v(r.color)}`],r.invisible&&t.invisible]}})(it(({theme:e})=>({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(12),minWidth:Y*2,lineHeight:1,padding:"0 6px",height:Y*2,borderRadius:Y,zIndex:1,transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.enteringScreen}),variants:[...Object.entries(e.palette).filter(pt(["contrastText"])).map(([t])=>({props:{color:t},style:{backgroundColor:(e.vars||e).palette[t].main,color:(e.vars||e).palette[t].contrastText}})),{props:{variant:"dot"},style:{borderRadius:J,height:J*2,minWidth:J*2,padding:0}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${L.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${L.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${L.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${L.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${L.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${L.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${L.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${L.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.leavingScreen})}}]})));function at(e){return{vertical:(e==null?void 0:e.vertical)??"top",horizontal:(e==null?void 0:e.horizontal)??"right"}}const Ot=d.forwardRef(function(t,r){const s=F({props:t,name:"MuiBadge"}),{anchorOrigin:a,className:c,classes:l,component:i,components:o={},componentsProps:m={},children:g,overlap:u="rectangular",color:b="default",invisible:f=!1,max:C=99,badgeContent:A,slots:h,slotProps:p,showZero:I=!1,variant:S="standard",...M}=s,{badgeContent:j,invisible:y,max:z,displayValue:x}=It({max:C,invisible:f,badgeContent:A,showZero:I}),D=lt({anchorOrigin:at(a),color:b,overlap:u,variant:S,badgeContent:A}),$=y||j==null&&S!=="dot",{color:W=b,overlap:E=u,anchorOrigin:w,variant:P=S}=$?D:s,T=at(w),R=P!=="dot"?x:void 0,Q={...s,badgeContent:j,invisible:$,max:z,displayValue:R,showZero:I,anchorOrigin:T,color:W,overlap:E,variant:P},X=Rt(Q),tt=(h==null?void 0:h.root)??o.Root??Pt,et=(h==null?void 0:h.badge)??o.Badge??Lt,V=(p==null?void 0:p.root)??m.root,H=(p==null?void 0:p.badge)??m.badge,ct=rt({elementType:tt,externalSlotProps:V,externalForwardedProps:M,additionalProps:{ref:r,as:i},ownerState:Q,className:B(V==null?void 0:V.className,X.root,c)}),dt=rt({elementType:et,externalSlotProps:H,ownerState:Q,className:B(X.badge,H==null?void 0:H.className)});return n.jsxs(tt,{...ct,children:[g,n.jsx(et,{...dt,children:R})]})});function At(e){return q("MuiListItem",e)}U("MuiListItem",["root","container","dense","alignItemsFlexStart","divider","gutters","padding","secondaryAction"]);const jt=U("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]);function $t(e){return q("MuiListItemSecondaryAction",e)}U("MuiListItemSecondaryAction",["root","disableGutters"]);const Tt=e=>{const{disableGutters:t,classes:r}=e;return G({root:["root",t&&"disableGutters"]},$t,r)},Bt=N("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.disableGutters&&t.disableGutters]}})({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)",variants:[{props:({ownerState:e})=>e.disableGutters,style:{right:0}}]}),K=d.forwardRef(function(t,r){const s=F({props:t,name:"MuiListItemSecondaryAction"}),{className:a,...c}=s,l=d.useContext(k),i={...s,disableGutters:l.disableGutters},o=Tt(i);return n.jsx(Bt,{className:B(o.root,a),ownerState:i,ref:r,...c})});K.muiName="ListItemSecondaryAction";const Nt=(e,t)=>{const{ownerState:r}=e;return[t.root,r.dense&&t.dense,r.alignItems==="flex-start"&&t.alignItemsFlexStart,r.divider&&t.divider,!r.disableGutters&&t.gutters,!r.disablePadding&&t.padding,r.hasSecondaryAction&&t.secondaryAction]},Mt=e=>{const{alignItems:t,classes:r,dense:s,disableGutters:a,disablePadding:c,divider:l,hasSecondaryAction:i}=e;return G({root:["root",s&&"dense",!a&&"gutters",!c&&"padding",l&&"divider",t==="flex-start"&&"alignItemsFlexStart",i&&"secondaryAction"],container:["container"]},At,r)},wt=N("div",{name:"MuiListItem",slot:"Root",overridesResolver:Nt})(it(({theme:e})=>({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left",variants:[{props:({ownerState:t})=>!t.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:t})=>!t.disablePadding&&t.dense,style:{paddingTop:4,paddingBottom:4}},{props:({ownerState:t})=>!t.disablePadding&&!t.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:t})=>!t.disablePadding&&!!t.secondaryAction,style:{paddingRight:48}},{props:({ownerState:t})=>!!t.secondaryAction,style:{[`& > .${jt.root}`]:{paddingRight:48}}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:t})=>t.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:t})=>t.button,style:{transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}}},{props:({ownerState:t})=>t.hasSecondaryAction,style:{paddingRight:48}}]}))),kt=N("li",{name:"MuiListItem",slot:"Container",overridesResolver:(e,t)=>t.container})({position:"relative"}),zt=d.forwardRef(function(t,r){const s=F({props:t,name:"MuiListItem"}),{alignItems:a="center",children:c,className:l,component:i,components:o={},componentsProps:m={},ContainerComponent:g="li",ContainerProps:{className:u,...b}={},dense:f=!1,disableGutters:C=!1,disablePadding:A=!1,divider:h=!1,secondaryAction:p,slotProps:I={},slots:S={},...M}=s,j=d.useContext(k),y=d.useMemo(()=>({dense:f||j.dense||!1,alignItems:a,disableGutters:C}),[a,j.dense,f,C]),z=d.useRef(null),x=d.Children.toArray(c),D=x.length&&xt(x[x.length-1],["ListItemSecondaryAction"]),$={...s,alignItems:a,dense:y.dense,disableGutters:C,disablePadding:A,divider:h,hasSecondaryAction:D},W=Mt($),E=mt(z,r),w=S.root||o.Root||wt,P=I.root||m.root||{},T={className:B(W.root,P.className,l),...M};let R=i||"li";return D?(R=!T.component&&!i?"div":R,g==="li"&&(R==="li"?R="div":T.component==="li"&&(T.component="div")),n.jsx(k.Provider,{value:y,children:n.jsxs(kt,{as:g,className:B(W.container,u),ref:E,ownerState:$,...b,children:[n.jsx(w,{...P,...!nt(w)&&{as:R,ownerState:{...$,...P.ownerState}},...T,children:x}),x.pop()]})})):n.jsx(k.Provider,{value:y,children:n.jsxs(w,{...P,as:R,ref:E,...!nt(w)&&{ownerState:{...$,...P.ownerState}},...T,children:[x,p&&n.jsx(K,{children:p})]})})});function Ut(e){return q("MuiListItemAvatar",e)}U("MuiListItemAvatar",["root","alignItemsFlexStart"]);const Ft=e=>{const{alignItems:t,classes:r}=e;return G({root:["root",t==="flex-start"&&"alignItemsFlexStart"]},Ut,r)},Gt=N("div",{name:"MuiListItemAvatar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.alignItems==="flex-start"&&t.alignItemsFlexStart]}})({minWidth:56,flexShrink:0,variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}),Dt=d.forwardRef(function(t,r){const s=F({props:t,name:"MuiListItemAvatar"}),{className:a,...c}=s,l=d.useContext(k),i={...s,alignItems:l.alignItems},o=Ft(i);return n.jsx(Gt,{className:B(o.root,a),ownerState:i,ref:r,...c})}),Wt=e=>{const{classes:t,inset:r,primary:s,secondary:a,dense:c}=e;return G({root:["root",r&&"inset",c&&"dense",s&&a&&"multiline"],primary:["primary"],secondary:["secondary"]},Ct,t)},Et=N("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[{[`& .${Z.primary}`]:t.primary},{[`& .${Z.secondary}`]:t.secondary},t.root,r.inset&&t.inset,r.primary&&r.secondary&&t.multiline,r.dense&&t.dense]}})({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4,[`.${ot.root}:where(& .${Z.primary})`]:{display:"block"},[`.${ot.root}:where(& .${Z.secondary})`]:{display:"block"},variants:[{props:({ownerState:e})=>e.primary&&e.secondary,style:{marginTop:6,marginBottom:6}},{props:({ownerState:e})=>e.inset,style:{paddingLeft:56}}]}),Vt=d.forwardRef(function(t,r){const s=F({props:t,name:"MuiListItemText"}),{children:a,className:c,disableTypography:l=!1,inset:i=!1,primary:o,primaryTypographyProps:m,secondary:g,secondaryTypographyProps:u,slots:b={},slotProps:f={},...C}=s,{dense:A}=d.useContext(k);let h=o??a,p=g;const I={...s,disableTypography:l,inset:i,primary:!!h,secondary:!!p,dense:A},S=Wt(I),M={slots:b,slotProps:{primary:m,secondary:u,...f}},[j,y]=st("primary",{className:S.primary,elementType:O,externalForwardedProps:M,ownerState:I}),[z,x]=st("secondary",{className:S.secondary,elementType:O,externalForwardedProps:M,ownerState:I});return h!=null&&h.type!==O&&!l&&(h=n.jsx(j,{variant:A?"body2":"body1",component:y!=null&&y.variant?void 0:"span",...y,children:h})),p!=null&&p.type!==O&&!l&&(p=n.jsx(z,{variant:"body2",color:"textSecondary",...x,children:p})),n.jsxs(Et,{className:B(S.root,c),ownerState:I,ref:r,...C,children:[h,p]})}),Ht=({chatSessions:e,onDeleted:t})=>{const r=gt(),[s,a]=d.useState([]),c=o=>{const m=o.finderEphemeralId;return o.messages.some(g=>g.senderId===m&&!g.isRead)},l=(o,m)=>{m.preventDefault(),a(g=>g.includes(o)?g.filter(u=>u!==o):[...g,o])},i=async()=>{if(s.length!==0&&window.confirm("Are you sure you want to delete these chats?"))try{await Promise.all(s.map(o=>ht(o))),alert("Deleted successfully."),a([]),t==null||t()}catch(o){console.error("Failed to delete chats:",o)}};return n.jsxs(_,{sx:{position:"relative",width:"100%"},children:[s.length>0&&n.jsx(_,{sx:{textAlign:"right",mb:1},children:n.jsx(ut,{variant:"contained",color:"error",onClick:i,children:"Delete Selected"})}),n.jsx(yt,{sx:{width:"100%",bgcolor:"var(--card-background)",borderRadius:2,boxShadow:1,overflow:"hidden"},children:e.map(o=>{const m=o.finderName||"Unknown",g=o.finderSurname||"User",u=c(o),b=s.includes(o.chatSessionId);return n.jsxs(zt,{onClick:()=>{s.length>0?a(f=>b?f.filter(C=>C!==o.chatSessionId):[...f,o.chatSessionId]):r(`/owner-chat/${o.chatSessionId}`)},onContextMenu:f=>l(o.chatSessionId,f),sx:{cursor:"pointer",mb:1,borderRadius:2,backgroundColor:b?"var(--input-background)":u?"rgba(255, 87, 87, 0.1)":"inherit",borderLeft:u?"4px solid rgba(244, 67, 54, 0.7)":"4px solid transparent","&:hover":{backgroundColor:"var(--divider-color)"}},children:[n.jsx(Dt,{children:n.jsx(bt,{sx:{bgcolor:u?"error.main":"primary.main"},children:m.charAt(0).toUpperCase()})}),n.jsx(Vt,{primary:n.jsxs(O,{fontWeight:u?"bold":"normal",sx:{color:"var(--text-color)"},children:["Chat with ",m," ",g]}),secondary:n.jsx(O,{sx:{color:"var(--text-color-secondary)",fontSize:"0.9rem"},children:u?"New unread messages from finder":"All messages read"})}),n.jsx(K,{children:u&&n.jsx(Ot,{color:"error",variant:"dot",overlap:"circular",children:n.jsx(_,{sx:{width:24,height:24}})})})]},o.chatSessionId)})})]})},te=()=>{const[e,t]=d.useState([]),r=async()=>{try{const s=await ft();t(s)}catch(s){console.error(s)}};return d.useEffect(()=>{r()},[]),n.jsx(vt,{children:n.jsxs(_,{sx:{maxWidth:"600px",margin:"auto",padding:"16px",textAlign:"center"},children:[n.jsx(O,{variant:"h5",sx:{mb:2},children:"Chat Sessions"}),e.length===0?n.jsx(O,{variant:"body2",sx:{opacity:.6},children:"No chat sessions found."}):n.jsx(Ht,{chatSessions:e,onDeleted:r})]})})};export{te as default};
