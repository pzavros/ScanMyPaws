import{f as y,u as k,r as o,j as r,B as a,c as t,P as I,a as C}from"./index-BkwN6ugi.js";import{f as j,s as w}from"./api-Dn10Jbrv.js";import{T as S}from"./TextField-Xo4kt7zH.js";import"./Grow-CBhhKj-Z.js";import"./isHostComponent-DVu5iVWx.js";import"./isMuiElement-BIwZpEg9.js";import"./Select-CVW7Cr0N.js";import"./List-CSE9cjs2.js";const A=()=>{const{sessionId:n}=y(),g=k(),[p,h]=o.useState([]),[i,u]=o.useState(""),[f,m]=o.useState(null),d=o.useRef(null),c=o.useRef(!1);o.useEffect(()=>{const e=sessionStorage.getItem("finderEphemeralId");if(!e){alert("Your chat session has expired."),g(-1);return}m(e),l();const s=setInterval(l,3e3);return()=>clearInterval(s)},[n]);const l=async()=>{try{const e=await j(n);h(e),c.current&&(v(),c.current=!1)}catch(e){console.error("Error fetching messages:",e)}},b=async()=>{if(!i.trim())return;const e=sessionStorage.getItem("finderEphemeralId");if(!e){console.error("Finder ID is missing.");return}try{c.current=!0,await w(n,i,e),u(""),l()}catch(s){console.error(s)}},v=()=>{var e;(e=d.current)==null||e.scrollTo({top:d.current.scrollHeight,behavior:"smooth"})};return r.jsxs(a,{sx:{display:"flex",flexDirection:"column",height:"100vh",maxWidth:"600px",margin:"auto",backgroundColor:"var(--background-color)",color:"var(--text-color)",boxShadow:"0px 4px 10px rgba(0, 0, 0, 0.2)"},children:[r.jsx(a,{sx:{padding:"12px",textAlign:"center",backgroundColor:"var(--background-color)",boxShadow:"0px 4px 10px rgba(0, 0, 0, 0.2)"},children:r.jsx(t,{variant:"h5",children:"Chat with the Owner"})}),r.jsx(a,{ref:d,sx:{flex:1,padding:"16px",overflowY:"auto",backgroundColor:"var(--card-background)",borderRadius:"8px",display:"flex",flexDirection:"column"},children:p.length===0?r.jsx(t,{variant:"body2",sx:{textAlign:"center",opacity:.6},children:"No messages yet."}):p.map((e,s)=>{const x=e.senderId===f;return r.jsx(a,{sx:{display:"flex",flexDirection:x?"row-reverse":"row",alignItems:"center",mb:1},children:r.jsxs(I,{sx:{padding:"8px 12px",borderRadius:"16px",backgroundColor:x?"#1976d2":"#e0e0e0",color:x?"#fff":"#000",maxWidth:"75%",wordBreak:"break-word",boxShadow:"2px 2px 5px rgba(0,0,0,0.1)"},children:[r.jsx(t,{variant:"body1",children:e.messageContent}),r.jsx(t,{variant:"caption",sx:{display:"block",textAlign:"right",opacity:.6,fontSize:"0.75rem",marginTop:"4px"},children:e.sentAt})]})},s)})}),r.jsxs(a,{sx:{position:"fixed",bottom:0,left:0,right:0,display:"flex",gap:1,padding:"10px",backgroundColor:"var(--background-color)",borderTop:"1px solid #ddd",zIndex:1e3},children:[r.jsx(S,{fullWidth:!0,variant:"outlined",placeholder:"Type your message...",value:i,onChange:e=>u(e.target.value),sx:{backgroundColor:"var(--input-background)",borderRadius:"25px","& .MuiOutlinedInput-root":{borderRadius:"25px",paddingLeft:"12px"}}}),r.jsx(C,{variant:"contained",onClick:b,sx:{borderRadius:"50px",padding:"12px 20px",backgroundColor:"#1976d2","&:hover":{backgroundColor:"#1565c0"}},children:"Send"})]})]})};export{A as default};
